<section class="space-y-6">
  <div class="space-y-2">
    <p class="text-xs uppercase tracking-[0.3em] text-neutral-400">Practice onboarding</p>
    <h1 class="text-2xl font-semibold text-neutral-900">Create your practice</h1>
    <p class="text-sm text-neutral-600">
      Set up the clinic profile your care team will use to coordinate patients.
    </p>
  </div>

  <form class="space-y-5" [formGroup]="form" (ngSubmit)="onSubmit()">
    <lib-form-field
      [label]="'Practice name'"
      [hint]="'Displayed on patient communications.'"
      [error]="nameError"
      [fieldId]="nameId"
      [required]="true"
    >
      <input
        formFieldControl
        type="text"
        autocomplete="organization"
        [id]="nameId"
        [attr.aria-describedby]="nameDescribedBy"
        formControlName="name"
        class="w-full bg-transparent text-sm text-neutral-900 placeholder:text-neutral-400 focus:outline-none"
        placeholder="Eloquia Family Clinic"
      />
    </lib-form-field>

    <lib-form-field
      [label]="'Practice address'"
      [hint]="'Optional, helpful for patient reminders.'"
      [fieldId]="addressId"
    >
      <input
        formFieldControl
        type="text"
        autocomplete="street-address"
        [id]="addressId"
        [attr.aria-describedby]="addressDescribedBy"
        formControlName="address"
        class="w-full bg-transparent text-sm text-neutral-900 placeholder:text-neutral-400 focus:outline-none"
        placeholder="123 Calm Street, Suite 4"
      />
    </lib-form-field>

    <lib-form-field
      [label]="'Logo URL'"
      [hint]="'Optional, you can upload later.'"
      [fieldId]="logoId"
    >
      <input
        formFieldControl
        type="url"
        autocomplete="url"
        [id]="logoId"
        [attr.aria-describedby]="logoDescribedBy"
        formControlName="logoUrl"
        class="w-full bg-transparent text-sm text-neutral-900 placeholder:text-neutral-400 focus:outline-none"
        placeholder="https://clinic.com/logo.png"
      />
    </lib-form-field>

    <div
      *ngIf="formError"
      class="rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700"
      role="alert"
    >
      {{ formError }}
    </div>

    <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
      <lib-button
        [type]="'submit'"
        [variant]="'primary'"
        [size]="'lg'"
        [loading]="loading"
        [disabled]="loading"
        class="w-full sm:w-auto"
      >
        Create practice
      </lib-button>
      <p class="text-xs text-neutral-500">
        You can refine details later in settings.
      </p>
    </div>

    <div class="flex items-center justify-between rounded-xl border border-dashed border-neutral-200/70 bg-neutral-50 px-3 py-3">
      <div>
        <p class="text-sm font-medium text-neutral-900">Guided walkthrough</p>
        <p class="text-xs text-neutral-500">Preview the tutorial you will see after setup.</p>
      </div>
      <lib-button
        type="button"
        variant="ghost"
        size="sm"
        (click)="startTour(tourStep)"
      >
        Preview tour
      </lib-button>
    </div>
  </form>
</section>

<section
  *ngIf="tourVisible"
  class="fixed inset-0 z-50 bg-neutral-900/40 backdrop-blur-sm"
  aria-label="Onboarding tour"
>
  <div class="flex min-h-full items-center justify-center px-4">
    <div class="w-full max-w-lg rounded-2xl bg-white p-6 shadow-[var(--shadow-md)] ring-1 ring-neutral-200/70">
      <div class="flex items-start justify-between gap-4">
        <div>
          <p class="text-xs uppercase tracking-[0.3em] text-neutral-400">Step {{ tourStep + 1 }} of {{ tourSteps.length }}</p>
          <h2 class="mt-2 text-lg font-semibold text-neutral-900">
            {{ tourSteps[tourStep].title }}
          </h2>
          <p class="mt-2 text-sm text-neutral-600">
            {{ tourSteps[tourStep].body }}
          </p>
        </div>
        <button type="button" class="text-sm text-neutral-500 hover:text-neutral-800" (click)="skipTour()">
          Skip
        </button>
      </div>

      <div
        class="mt-4 grid gap-2"
        aria-hidden="true"
        [style.gridTemplateColumns]="'repeat(' + tourSteps.length + ', minmax(0,1fr))'"
      >
        <div
          *ngFor="let step of tourSteps; let idx = index"
          class="h-1 rounded-full"
          [class.bg-neutral-900]="idx <= tourStep"
          [class.bg-neutral-200]="idx > tourStep"
        ></div>
      </div>

      <div class="mt-6 flex items-center justify-end gap-3">
        <lib-button type="button" variant="ghost" size="sm" (click)="skipTour()">
          Skip tour
        </lib-button>
        <lib-button type="button" variant="primary" size="sm" (click)="nextTour()">
          {{ tourStep === tourSteps.length - 1 ? 'Finish & go to patients' : 'Next' }}
        </lib-button>
      </div>
    </div>
  </div>
</section>
